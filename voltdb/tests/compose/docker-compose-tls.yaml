version: '3'

services:
  voltdb0:
    image: voltdb/voltdb-community:8.4.2
    container_name: voltdb0
    environment:
      - HOST_COUNT=3
      - HOSTS=voltdb0,voltdb1,voltdb2
    volumes:
      - ./deployment-tls.xml:/tmp/deployment.xml
      - $TLS_OUTPUT_DIR:/tmp/tlsoutput
      - ./tlsstart.sh:/tmp/tlsstart.sh
    entrypoint: ["sh", "/tmp/tlsstart.sh"]
    ports:
      - ${VOLTDB_CLIENT_PORT}:8443  # JSON Interface: https://docs.voltdb.com/UsingVoltDB/ProgLangJson.php

  voltdb1:
    image: voltdb/voltdb-community:8.4.2
    container_name: voltdb1
    environment:
      - HOST_COUNT=3
      - HOSTS=voltdb0,voltdb1,voltdb2
    volumes:
      - ./deployment-tls.xml:/tmp/deployment.xml
      - ./tlsstart.sh:/tmp/tlsstart.sh
    entrypoint: ["sh", "/tmp/tlsstart.sh"]

  voltdb2:
    image: voltdb/voltdb-community:8.4.2
    container_name: voltdb2
    environment:
      - HOST_COUNT=3
      - HOSTS=voltdb0,voltdb1,voltdb2
    volumes:
      - ./deployment-tls.xml:/tmp/deployment.xml
      - ./tlsstart.sh:/tmp/tlsstart.sh
    entrypoint: ["sh", "/tmp/tlsstart.sh"]
